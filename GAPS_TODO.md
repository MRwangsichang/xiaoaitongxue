# ä¿¡æ¯ç¼ºå£ä¸å¾…è¡¥äº‹é¡¹

**æ›´æ–°æ—¶é—´**: 2025-11-06  
**ç”¨é€”**: è®°å½•éœ€è¦è¡¥å……çš„ä¿¡æ¯ã€æœªè§£å†³çš„é—®é¢˜ã€å¾…éªŒè¯çš„å‡è®¾

---

## ğŸ”´ **P0 - é˜»å¡æ€§é—®é¢˜ï¼ˆå¿…é¡»è§£å†³ï¼‰**

### GAPS-P0-001: ASRéŸ³é¢‘è®¾å¤‡å†²çª
**é—®é¢˜**: ASRæ¨¡å—æ— æ³•æ‰“å¼€éº¦å…‹é£ï¼ŒæŠ¥é”™ `OSError: [Errno -9999]`

**åŸå› **: PulseAudio/PipeWireå ç”¨USBéº¦å…‹é£(plughw:1,0)

**å½±å“**: 
- âŒ æ— æ³•é€šè¿‡è¯­éŸ³è§¦å‘å¯¹è¯
- âŒ å”¤é†’è¯æµ‹è¯•åªèƒ½æ‰‹åŠ¨å‘é€MQTTæ¶ˆæ¯
- âŒ å®Œæ•´è¯­éŸ³äº¤äº’æµç¨‹ä¸å¯ç”¨

**éœ€è¦çš„ä¿¡æ¯**:
1. PulseAudio/PipeWireæ˜¯å¦å¿…éœ€ï¼Ÿï¼ˆç”¨äºä»€ä¹ˆï¼‰
2. å¦‚ä½•é…ç½®è®©PyAudioä¼˜å…ˆè®¿é—®éº¦å…‹é£ï¼Ÿ
3. æ˜¯å¦éœ€è¦ç¦ç”¨æ¡Œé¢éŸ³é¢‘æœåŠ¡ï¼Ÿ

**éªŒè¯å‘½ä»¤**:
```bash
# 1. æ£€æŸ¥å ç”¨è¿›ç¨‹
lsof /dev/snd/* | grep pcm

# 2. æµ‹è¯•ç›´æ¥å½•éŸ³
timeout 3 arecord -D plughw:1,0 -f cd -d 3 /tmp/test.wav

# 3. æŸ¥çœ‹éŸ³é¢‘æœåŠ¡
systemctl --user status pipewire pipewire-pulse pulseaudio
```

**å¯èƒ½è§£å†³æ–¹æ¡ˆ**:
- æ–¹æ¡ˆA: é‡å¯éŸ³é¢‘æœåŠ¡åç«‹å³å¯åŠ¨ASR
- æ–¹æ¡ˆB: ä¿®æ”¹ASRä½¿ç”¨ä¸åŒçš„éŸ³é¢‘åç«¯ï¼ˆALSAç›´æ¥è®¿é—®ï¼‰
- æ–¹æ¡ˆC: ä½¿ç”¨USBéŸ³é¢‘ç‹¬å æ¨¡å¼

**è´£ä»»äºº**: å¾…åˆ†é…  
**æˆªæ­¢æ—¥æœŸ**: 2025-11-08

---

### GAPS-P0-002: Gitä»“åº“æœªåˆå§‹åŒ–
**é—®é¢˜**: é¡¹ç›®æœªä½¿ç”¨Gitç‰ˆæœ¬æ§åˆ¶

**å½±å“**:
- âŒ æ— æ³•è¿½è¸ªä»£ç å˜æ›´å†å²
- âŒ å›æ»šåªèƒ½ä¾èµ–.bakæ–‡ä»¶ï¼ˆä¸å¯é ï¼‰
- âŒ æ— æ³•ç”Ÿæˆç¨³å®šç‰ˆæœ¬æ ‡ç­¾
- âŒ Claude Codeåä½œå›°éš¾

**éœ€è¦çš„ä¿¡æ¯**:
1. æ˜¯å¦æœ‰GitHubè´¦å·ï¼Ÿ
2. ä»“åº“å‘½ååå¥½ï¼Ÿï¼ˆå»ºè®®ï¼šsmart-assistantï¼‰
3. æ˜¯å¦éœ€è¦.gitignoreæ’é™¤æ•æ„Ÿæ–‡ä»¶ï¼Ÿ

**å¾…æ‰§è¡Œå‘½ä»¤**:
```bash
# 1. åˆå§‹åŒ–Git
cd ~/smart_assistant
git init

# 2. åˆ›å»º.gitignore
cat > .gitignore <<'EOF'
# æ•æ„Ÿä¿¡æ¯
.env.local
*.key

# æ—¥å¿—
logs/
*.log

# ä¸´æ—¶æ–‡ä»¶
__pycache__/
*.pyc
*.bak_*

# æ•°æ®
data/memory/*.db
data/faces/raw/

# å¤‡ä»½
backups/
*.tar.gz
EOF

# 3. é¦–æ¬¡æäº¤
git add .
git commit -m "Initial commit - MVP v1.0 baseline"

# 4. åˆ›å»ºç¨³å®šç‰ˆæœ¬æ ‡ç­¾
git tag -a v1.0-wakeword -m "Wakeword service integrated"
```

**è´£ä»»äºº**: ç‹æ€»  
**æˆªæ­¢æ—¥æœŸ**: 2025-11-07

---

## ğŸŸ¡ **P1 - é‡è¦ä½†ä¸é˜»å¡ï¼ˆå»ºè®®è§£å†³ï¼‰**

### GAPS-P1-001: æ–‡ä»¶å“ˆå¸Œå€¼ç¼ºå¤±
**é—®é¢˜**: æ— æ³•éªŒè¯å…³é”®è„šæœ¬çš„å®Œæ•´æ€§

**å½±å“**:
- âš ï¸ å›æ»šåä¸ç¡®å®šæ˜¯å¦æ¢å¤åˆ°æ­£ç¡®ç‰ˆæœ¬
- âš ï¸ æ–‡æ¡£ä¸­çš„"ä»¥å“ªä¸ªç‰ˆæœ¬ä¸ºå‡†"ä¸å¯éªŒè¯

**éœ€è¦çš„ä¿¡æ¯**:
å…³é”®æ–‡ä»¶çš„SHA256å“ˆå¸Œå€¼ï¼š
- `scripts/start_asr.sh`
- `scripts/start_rules.sh`
- `scripts/start_tts.sh`
- `scripts/start_wakeword.sh`
- `scripts/start_greeting.sh`
- `scripts/start_vision_scanner.sh`

**éªŒè¯å‘½ä»¤**:
```bash
cd ~/smart_assistant

# æ‰¹é‡è®¡ç®—å“ˆå¸Œ
for file in scripts/start_*.sh; do
  sha256sum "$file" | tee -a docs/BASELINE.md
done

# æœŸæœ›è¾“å‡ºæ ¼å¼:
# <hash>  scripts/start_asr.sh
# <hash>  scripts/start_rules.sh
# ...
```

**è´£ä»»äºº**: Claude Code  
**æˆªæ­¢æ—¥æœŸ**: 2025-11-09

---

### GAPS-P1-002: ç¯å¢ƒå˜é‡æ–‡æ¡£ç¼ºå¤±
**é—®é¢˜**: .env.localæ–‡ä»¶æœªæä¾›ç¤ºä¾‹ï¼Œä¸çŸ¥é“éœ€è¦å“ªäº›å˜é‡

**å½±å“**:
- âš ï¸ æ–°éƒ¨ç½²æ—¶ä¸çŸ¥é“è¦é…ç½®ä»€ä¹ˆ
- âš ï¸ æ–‡æ¡£ä¸å®Œæ•´

**éœ€è¦çš„ä¿¡æ¯**:
1. GROK_API_KEY æ˜¯å¦å¿…éœ€ï¼Ÿ
2. XUNFEI_* ç³»åˆ—å˜é‡çš„å®Œæ•´åˆ—è¡¨
3. æ˜¯å¦æœ‰å…¶ä»–æ•æ„Ÿé…ç½®ï¼Ÿ

**å¾…æ‰§è¡Œå‘½ä»¤**:
```bash
# åˆ›å»º.env.exampleï¼ˆä¸å«çœŸå®å¯†é’¥ï¼‰
cd ~/smart_assistant

cat > config/.env.example <<'ENV_EOF'
# Grok AI APIå¯†é’¥
GROK_API_KEY=your_grok_api_key_here

# è®¯é£è¯­éŸ³è¯†åˆ«
XUNFEI_APP_ID=your_app_id
XUNFEI_API_KEY=your_api_key
XUNFEI_API_SECRET=your_api_secret

# è®¯é£è¯­éŸ³åˆæˆ
XUNFEI_TTS_APP_ID=your_tts_app_id
XUNFEI_TTS_API_KEY=your_tts_api_key

# MQTTé…ç½®ï¼ˆå¯é€‰ï¼Œé»˜è®¤localhost:1883ï¼‰
MQTT_BROKER=localhost
MQTT_PORT=1883

# æ—¥å¿—çº§åˆ«ï¼ˆå¯é€‰ï¼Œé»˜è®¤INFOï¼‰
LOG_LEVEL=INFO

# ä»£ç†é…ç½®ï¼ˆå¯é€‰ï¼Œç”¨äºGrok APIï¼‰
SOCKS5_PROXY=127.0.0.1:1080
ENV_EOF

echo "âœ“ å·²åˆ›å»º config/.env.example"
```

**è´£ä»»äºº**: ç‹æ€»ï¼ˆæä¾›å˜é‡åˆ—è¡¨ï¼‰  
**æˆªæ­¢æ—¥æœŸ**: 2025-11-08

---

### GAPS-P1-003: æ€§èƒ½åŸºå‡†æ•°æ®ç¼ºå¤±
**é—®é¢˜**: ç¼ºå°‘å„æ¨¡å—çš„æ€§èƒ½åŸºå‡†æµ‹è¯•æ•°æ®

**å½±å“**:
- âš ï¸ æ— æ³•åˆ¤æ–­æ€§èƒ½æ˜¯å¦é€€åŒ–
- âš ï¸ ä¼˜åŒ–åæ— æ³•å¯¹æ¯”æ•ˆæœ

**éœ€è¦çš„ä¿¡æ¯**:
| æ¨¡å— | æŒ‡æ ‡ | å½“å‰å€¼ | ç›®æ ‡å€¼ |
|------|------|-------|-------|
| ASR | è¯†åˆ«å‡†ç¡®ç‡ | TBD | >90% |
| ASR | å“åº”å»¶è¿Ÿ | TBD | <1ç§’ |
| Wakeword | å”¤é†’å“åº” | ~1.5ç§’ | <2ç§’ |
| TTS | æ’­æŠ¥å»¶è¿Ÿ | TBD | <1ç§’ |
| Vision | è¯†åˆ«å‡†ç¡®ç‡ | ~90% | >85% |
| Rules | Grokè°ƒç”¨å»¶è¿Ÿ | TBD | <2ç§’ |

**éªŒè¯å‘½ä»¤**:
```bash
# æµ‹è¯•ASRå»¶è¿Ÿï¼ˆéœ€ä¿®å¤éŸ³é¢‘è®¾å¤‡åï¼‰
# TBD

# æµ‹è¯•Wakewordå»¶è¿Ÿ
START=$(date +%s%3N)
mosquitto_pub -t 'sa/asr/text' -m '{"payload":{"text":"æ˜Ÿè¾°åœ¨å—"}}'
# ï¼ˆç­‰å¾…éŸ³ç®±æ’­æŠ¥ï¼‰
END=$(date +%s%3N)
echo "å”¤é†’å»¶è¿Ÿ: $((END - START)) ms"

# æµ‹è¯•Grokè°ƒç”¨å»¶è¿Ÿ
proxychains4 time curl -s https://api.x.ai/v1/chat/completions -X POST -d '{"messages":[{"role":"user","content":"ä½ å¥½"}]}'
```

**è´£ä»»äºº**: Claude Code  
**æˆªæ­¢æ—¥æœŸ**: 2025-11-10

---

### GAPS-P1-004: æ‘„åƒå¤´è®¾å¤‡è·¯å¾„æœªéªŒè¯
**é—®é¢˜**: å‡è®¾æ‘„åƒå¤´æ˜¯ /dev/video0ï¼Œä½†æœªéªŒè¯

**å½±å“**:
- âš ï¸ å¦‚æœè®¾å¤‡è·¯å¾„é”™è¯¯ï¼Œè§†è§‰æ‰«æä¼šå¤±è´¥

**éœ€è¦çš„ä¿¡æ¯**:
```bash
# åˆ—å‡ºæ‰€æœ‰è§†é¢‘è®¾å¤‡
ls -l /dev/video*

# æŸ¥çœ‹è®¾å¤‡ä¿¡æ¯
v4l2-ctl --list-devices

# æœŸæœ›è¾“å‡º:
# mmal service 16.1 (platform:bcm2835-v4l2):
#   /dev/video0
```

**éªŒè¯å‘½ä»¤**:
```bash
# æµ‹è¯•æ‘„åƒå¤´
cd ~/smart_assistant
python3 <<'PY'
import cv2
cap = cv2.VideoCapture(0)
if cap.isOpened():
    print("âœ“ /dev/video0 å¯ç”¨")
    ret, frame = cap.read()
    if ret:
        print(f"âœ“ åˆ†è¾¨ç‡: {frame.shape[1]}x{frame.shape[0]}")
    cap.release()
else:
    print("âœ— /dev/video0 ä¸å¯ç”¨")
PY
```

**è´£ä»»äºº**: ç‹æ€»  
**æˆªæ­¢æ—¥æœŸ**: 2025-11-08

---

## ğŸŸ¢ **P2 - ä¼˜åŒ–é¡¹ï¼ˆæœ‰æ—¶é—´å†åšï¼‰**

### GAPS-P2-001: SystemdæœåŠ¡é…ç½®æœªæµ‹è¯•
**é—®é¢˜**: è™½ç„¶æœ‰æ¨¡æ¿ï¼Œä½†æœªå®é™…é…ç½®å’Œæµ‹è¯•

**å½±å“**:
- âš ï¸ æ— æ³•å®ç°å¼€æœºè‡ªå¯åŠ¨
- âš ï¸ è¿›ç¨‹å´©æºƒä¸ä¼šè‡ªåŠ¨é‡å¯

**éœ€è¦çš„ä¿¡æ¯**:
1. æ˜¯å¦éœ€è¦å¼€æœºè‡ªå¯åŠ¨ï¼Ÿ
2. å“ªäº›æœåŠ¡éœ€è¦systemdæ‰˜ç®¡ï¼Ÿ

**å¾…æ‰§è¡Œ**:
```bash
# 1. ä¸ºæ¯ä¸ªæ¨¡å—åˆ›å»ºsystemdæœåŠ¡
sudo cp docs/sa-template.service.example /etc/systemd/system/sa-asr.service
# ï¼ˆä¿®æ”¹ExecStartè·¯å¾„ï¼‰

# 2. å¯ç”¨æœåŠ¡
sudo systemctl enable sa-asr.service
sudo systemctl start sa-asr.service

# 3. éªŒè¯
sudo systemctl status sa-asr.service
```

**è´£ä»»äºº**: æœªåˆ†é…  
**æˆªæ­¢æ—¥æœŸ**: æ— 

---

### GAPS-P2-002: æ—¥å¿—è½®è½¬æœªè‡ªåŠ¨åŒ–
**é—®é¢˜**: æ—¥å¿—æŒ‰æ—¥è½®è½¬ï¼Œä½†æœªé…ç½®è‡ªåŠ¨æ¸…ç†

**å½±å“**:
- âš ï¸ æ—¥å¿—ç›®å½•ä¼šæ— é™å¢é•¿
- âš ï¸ ç£ç›˜å¯èƒ½è¢«å æ»¡

**éœ€è¦çš„ä¿¡æ¯**:
å½“å‰æ—¥å¿—å¤§å°ï¼Ÿ
```bash
du -sh ~/smart_assistant/logs/
```

**å¾…æ‰§è¡Œ**:
```bash
# é…ç½®logrotateæˆ–cronä»»åŠ¡
# TBD
```

**è´£ä»»äºº**: æœªåˆ†é…  
**æˆªæ­¢æ—¥æœŸ**: æ— 

---

### GAPS-P2-003: é€€å‡ºè¯æœåŠ¡æœªå®ç°
**é—®é¢˜**: æœ‰é€€å‡ºè¯æ¨¡æ¿ï¼Œä½†æ— ç‹¬ç«‹æœåŠ¡ï¼ˆç±»ä¼¼Wakewordï¼‰

**å½±å“**:
- âš ï¸ é€€å‡ºè¯å“åº”æ…¢ï¼ˆèµ°å®Œæ•´Grokæµç¨‹ï¼‰
- âš ï¸ æ¶æ„ä¸å¯¹ç§°

**éœ€è¦çš„ä¿¡æ¯**:
æ˜¯å¦éœ€è¦ç‹¬ç«‹çš„é€€å‡ºè¯æœåŠ¡ï¼Ÿ

**å»ºè®®å®ç°**:
```
modules/exitword/exitword_service.py
config/exitword.yml
scripts/start_exitword.sh
```

**è´£ä»»äºº**: æœªåˆ†é…  
**æˆªæ­¢æ—¥æœŸ**: æ— 

---

### GAPS-P2-004: å¤šäººè„¸è¯†åˆ«æœªå®ç°
**é—®é¢˜**: å½“å‰ä»…æ”¯æŒå•äººè¯†åˆ«ï¼ˆç‹æ€»ï¼‰

**å½±å“**:
- âš ï¸ æ— æ³•è¯†åˆ«å…¶ä»–å®¶åº­æˆå‘˜
- âš ï¸ æ— æ³•ä¸ªæ€§åŒ–é—®å€™

**éœ€è¦çš„ä¿¡æ¯**:
1. æ˜¯å¦éœ€è¦å¤šäººè¯†åˆ«ï¼Ÿ
2. å®¶åº­æˆå‘˜æ•°é‡ï¼Ÿ
3. æ¯äººéœ€è¦æ”¶é›†å¤šå°‘è®­ç»ƒç…§ç‰‡ï¼Ÿ

**å»ºè®®å®ç°**:
```bash
# 1. ä¸ºæ¯ä¸ªæˆå‘˜æ”¶é›†ç…§ç‰‡
data/faces/raw/ç‹æ€»/
data/faces/raw/å®¶äººA/
data/faces/raw/å®¶äººB/

# 2. è®­ç»ƒæ¨¡å‹ï¼ˆæ”¯æŒå¤šæ ‡ç­¾ï¼‰
python3 scripts/train_multi_person_model.py

# 3. ä¿®æ”¹greetingæœåŠ¡ï¼Œæ ¹æ®è¯†åˆ«ç»“æœä¸ªæ€§åŒ–é—®å€™
```

**è´£ä»»äºº**: æœªåˆ†é…  
**æˆªæ­¢æ—¥æœŸ**: æ— 

---

## ğŸ“Š **ç¼ºå£æ€»ç»“**

| ä¼˜å…ˆçº§ | æ•°é‡ | é˜»å¡é¡¹ | é¢„è®¡è§£å†³æ—¶é—´ |
|--------|------|--------|------------|
| P0 | 2 | ASRéŸ³é¢‘ã€Gitä»“åº“ | 2å¤© |
| P1 | 4 | å“ˆå¸Œã€ç¯å¢ƒå˜é‡ã€æ€§èƒ½ã€è®¾å¤‡ | 3å¤© |
| P2 | 4 | Systemdã€æ—¥å¿—ã€é€€å‡ºè¯ã€å¤šäºº | å¾…å®š |
| **æ€»è®¡** | **10** | **2** | **5å¤©+** |

---

## ğŸ”„ **æ›´æ–°æœºåˆ¶**

æ¯å½“å‘ç°æ–°çš„ä¿¡æ¯ç¼ºå£ï¼ŒæŒ‰ä»¥ä¸‹æ ¼å¼æ·»åŠ ï¼š
```markdown
### GAPS-PX-XXX: é—®é¢˜æ ‡é¢˜
**é—®é¢˜**: ç®€è¿°
**å½±å“**: å½±å“èŒƒå›´
**éœ€è¦çš„ä¿¡æ¯**: å…·ä½“åˆ—è¡¨
**éªŒè¯å‘½ä»¤**: å¯æ‰§è¡Œå‘½ä»¤
**è´£ä»»äºº**: è°æ¥è§£å†³
**æˆªæ­¢æ—¥æœŸ**: YYYY-MM-DD
```

æ¯è§£å†³ä¸€ä¸ªç¼ºå£ï¼Œæ ‡è®°ä¸ºï¼š
```markdown
### ~~GAPS-PX-XXX: é—®é¢˜æ ‡é¢˜~~ âœ… å·²è§£å†³ (2025-11-XX)
```

---

**è¯æ®æ¥æº**: é¡¹ç›®ç°çŠ¶åˆ†æã€æœªéªŒè¯å‡è®¾ã€ç¼ºå¤±æ–‡æ¡£
